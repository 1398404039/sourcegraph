import { TPromise } from 'vs/base/common/winjs.base';
import { IVSCodeWindow } from 'vs/code/electron-main/window';
import { IEnvironmentService } from 'vs/platform/environment/common/environment';
import { ILogService } from 'vs/code/electron-main/log';
import { IStorageService } from 'vs/code/electron-main/storage';
import Event from 'vs/base/common/event';
export declare const ILifecycleService: {
    (...args: any[]): void;
    type: ILifecycleService;
};
export declare enum UnloadReason {
    CLOSE = 0,
    QUIT = 1,
    RELOAD = 2,
    LOAD = 3,
}
export interface ILifecycleService {
    _serviceBrand: any;
    /**
     * Will be true if an update was applied. Will only be true for each update once.
     */
    wasUpdated: boolean;
    /**
     * Due to the way we handle lifecycle with eventing, the general app.on('before-quit')
     * event cannot be used because it can be called twice on shutdown. Instead the onBeforeQuit
     * handler in this module can be used and it is only called once on a shutdown sequence.
     */
    onBeforeQuit: Event<void>;
    ready(): void;
    registerWindow(vscodeWindow: IVSCodeWindow): void;
    unload(vscodeWindow: IVSCodeWindow, reason: UnloadReason): TPromise<boolean>;
    quit(fromUpdate?: boolean): TPromise<boolean>;
}
export declare class LifecycleService implements ILifecycleService {
    private environmentService;
    private logService;
    private storageService;
    _serviceBrand: any;
    private static QUIT_FROM_UPDATE_MARKER;
    private windowToCloseRequest;
    private quitRequested;
    private pendingQuitPromise;
    private pendingQuitPromiseComplete;
    private oneTimeListenerTokenGenerator;
    private _wasUpdated;
    private _onBeforeQuit;
    onBeforeQuit: Event<void>;
    constructor(environmentService: IEnvironmentService, logService: ILogService, storageService: IStorageService);
    private handleUpdated();
    readonly wasUpdated: boolean;
    ready(): void;
    private registerListeners();
    registerWindow(vscodeWindow: IVSCodeWindow): void;
    unload(vscodeWindow: IVSCodeWindow, reason: UnloadReason): TPromise<boolean>;
    /**
     * A promise that completes to indicate if the quit request has been veto'd
     * by the user or not.
     */
    quit(fromUpdate?: boolean): TPromise<boolean>;
}
