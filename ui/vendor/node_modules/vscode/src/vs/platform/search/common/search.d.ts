import { PPromise, TPromise } from 'vs/base/common/winjs.base';
import uri from 'vs/base/common/uri';
import glob = require('vs/base/common/glob');
import { IFilesConfiguration } from 'vs/platform/files/common/files';
export declare const ID = "searchService";
export declare const ISearchService: {
    (...args: any[]): void;
    type: ISearchService;
};
/**
 * A service that enables to search for files or with in files.
 */
export interface ISearchService {
    _serviceBrand: any;
    search(query: ISearchQuery): PPromise<ISearchComplete, ISearchProgressItem>;
    searchRepo(query: ISearchQuery): PPromise<ISearchComplete, ISearchProgressItem>;
    extendQuery(query: ISearchQuery): void;
    clearCache(cacheKey: string): TPromise<void>;
}
export interface IQueryOptions {
    folderResources?: uri[];
    extraFileResources?: uri[];
    filePattern?: string;
    excludePattern?: glob.IExpression;
    includePattern?: glob.IExpression;
    maxResults?: number;
    sortByScore?: boolean;
    cacheKey?: string;
    fileEncoding?: string;
}
export interface ISearchQuery extends IQueryOptions {
    type: QueryType;
    contentPattern?: IPatternInfo;
}
export declare enum QueryType {
    File = 1,
    Text = 2,
}
export interface IPatternInfo {
    pattern: string;
    isRegExp?: boolean;
    isWordMatch?: boolean;
    isMultiline?: boolean;
    isCaseSensitive?: boolean;
}
export interface IFileMatch {
    resource?: uri;
    lineMatches?: ILineMatch[];
}
export interface ILineMatch {
    preview: string;
    lineNumber: number;
    offsetAndLengths: number[][];
}
export interface IProgress {
    total?: number;
    worked?: number;
}
export interface ISearchProgressItem extends IFileMatch, IProgress {
}
export interface ISearchComplete {
    limitHit?: boolean;
    results: IFileMatch[];
    stats: ISearchStats;
}
export interface ISearchStats {
    fromCache: boolean;
    resultCount: number;
    unsortedResultTime?: number;
    sortedResultTime?: number;
}
export interface ICachedSearchStats extends ISearchStats {
    cacheLookupStartTime: number;
    cacheFilterStartTime: number;
    cacheLookupResultTime: number;
    cacheEntryCount: number;
    joined?: ISearchStats;
}
export interface IUncachedSearchStats extends ISearchStats {
    traversal: string;
    errors: string[];
    fileWalkStartTime: number;
    fileWalkResultTime: number;
    directoriesWalked: number;
    filesWalked: number;
    cmdForkStartTime?: number;
    cmdForkResultTime?: number;
    cmdResultCount?: number;
}
export declare class FileMatch implements IFileMatch {
    resource: uri;
    lineMatches: LineMatch[];
    constructor(resource: uri);
}
export declare class LineMatch implements ILineMatch {
    preview: string;
    lineNumber: number;
    offsetAndLengths: number[][];
    constructor(preview: string, lineNumber: number, offsetAndLengths: number[][]);
}
export interface ISearchConfiguration extends IFilesConfiguration {
    search: {
        exclude: glob.IExpression;
    };
}
