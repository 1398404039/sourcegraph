import * as platform from 'vs/base/common/platform';
import { IEnvironmentService } from 'vs/platform/environment/common/environment';
import { IStorageService } from 'vs/code/electron-main/storage';
import { IPath, VSCodeWindow } from 'vs/code/electron-main/window';
import { ILifecycleService } from 'vs/code/electron-main/lifecycle';
import { IConfigurationService } from 'vs/platform/configuration/common/configuration';
import { IUpdateService } from 'vs/code/electron-main/update-manager';
import { ILogService } from 'vs/code/electron-main/log';
import { IWindowEventService } from 'vs/code/common/windows';
import { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';
import CommonEvent from 'vs/base/common/event';
import { ParsedArgs } from 'vs/platform/environment/node/argv';
export interface IOpenConfiguration {
    cli: ParsedArgs;
    userEnv?: platform.IProcessEnvironment;
    pathsToOpen?: string[];
    preferNewWindow?: boolean;
    forceNewWindow?: boolean;
    forceEmpty?: boolean;
    windowToUse?: VSCodeWindow;
    diffMode?: boolean;
}
export interface IRecentPathsList {
    folders: string[];
    files: string[];
}
export declare const IWindowsService: {
    (...args: any[]): void;
    type: IWindowsService;
};
export interface IWindowsService {
    _serviceBrand: any;
    onOpen(clb: (path: IPath) => void): () => void;
    onReady(clb: (win: VSCodeWindow) => void): () => void;
    onClose(clb: (id: number) => void): () => void;
    onNewWindowOpen: CommonEvent<number>;
    onWindowFocus: CommonEvent<number>;
    ready(initialUserEnv: platform.IProcessEnvironment): void;
    reload(win: VSCodeWindow, cli?: ParsedArgs): void;
    open(openConfig: IOpenConfiguration): VSCodeWindow[];
    openPluginDevelopmentHostWindow(openConfig: IOpenConfiguration): void;
    openFileFolderPicker(forceNewWindow?: boolean): void;
    openFilePicker(forceNewWindow?: boolean): void;
    openFolderPicker(forceNewWindow?: boolean): void;
    openAccessibilityOptions(): void;
    focusLastActive(cli: ParsedArgs): VSCodeWindow;
    getLastActiveWindow(): VSCodeWindow;
    findWindow(workspacePath: string, filePath?: string, extensionDevelopmentPath?: string): VSCodeWindow;
    openNewWindow(): void;
    sendToFocused(channel: string, ...args: any[]): void;
    sendToAll(channel: string, payload: any, windowIdsToIgnore?: number[]): void;
    getFocusedWindow(): VSCodeWindow;
    getWindowById(windowId: number): VSCodeWindow;
    getWindows(): VSCodeWindow[];
    getWindowCount(): number;
    getRecentPathsList(): IRecentPathsList;
    removeFromRecentPathsList(path: string): any;
    clearRecentPathsList(): void;
}
export declare class WindowEventService implements IWindowEventService {
    private windowsService;
    _serviceBrand: any;
    constructor(windowsService: IWindowsService);
    readonly onWindowFocus: CommonEvent<number>;
    readonly onNewWindowOpen: CommonEvent<number>;
}
export declare class WindowsManager implements IWindowsService {
    private instantiationService;
    private logService;
    private storageService;
    private environmentService;
    private lifecycleService;
    private updateService;
    private configurationService;
    _serviceBrand: any;
    private static MAX_TOTAL_RECENT_ENTRIES;
    private static recentPathsListStorageKey;
    private static workingDirPickerStorageKey;
    private static windowsStateStorageKey;
    private static WINDOWS;
    private eventEmitter;
    private initialUserEnv;
    private windowsState;
    private _onFocus;
    onWindowFocus: CommonEvent<number>;
    private _onNewWindow;
    onNewWindowOpen: CommonEvent<number>;
    constructor(instantiationService: IInstantiationService, logService: ILogService, storageService: IStorageService, environmentService: IEnvironmentService, lifecycleService: ILifecycleService, updateService: IUpdateService, configurationService: IConfigurationService);
    onOpen(clb: (path: IPath) => void): () => void;
    onReady(clb: (win: VSCodeWindow) => void): () => void;
    onClose(clb: (id: number) => void): () => void;
    ready(initialUserEnv: platform.IProcessEnvironment): void;
    private registerListeners();
    private onBroadcast(event, payload);
    reload(win: VSCodeWindow, cli?: ParsedArgs): void;
    open(openConfig: IOpenConfiguration): VSCodeWindow[];
    private addToRecentPathsList(path?, isFile?);
    removeFromRecentPathsList(path: string): void;
    clearRecentPathsList(): void;
    getRecentPathsList(workspacePath?: string, filesToOpen?: IPath[]): IRecentPathsList;
    private getWindowUserEnv(openConfig);
    openPluginDevelopmentHostWindow(openConfig: IOpenConfiguration): void;
    private toConfiguration(userEnv, cli, workspacePath?, filesToOpen?, filesToCreate?, filesToDiff?);
    private toIPath(anyPath, ignoreFileNotFound?, gotoLineMode?);
    private cliToPaths(cli, ignoreFileNotFound?);
    private openInBrowserWindow(configuration, forceNewWindow?, windowToUse?);
    private getNewWindowState(configuration);
    private ensureNoOverlap(state);
    openFileFolderPicker(forceNewWindow?: boolean): void;
    openFilePicker(forceNewWindow?: boolean, path?: string): void;
    openFolderPicker(forceNewWindow?: boolean): void;
    openAccessibilityOptions(): void;
    private doPickAndOpen(options);
    private getFileOrFolderPaths(options, clb);
    focusLastActive(cli: ParsedArgs): VSCodeWindow;
    getLastActiveWindow(): VSCodeWindow;
    findWindow(workspacePath: string, filePath?: string, extensionDevelopmentPath?: string): VSCodeWindow;
    openNewWindow(): void;
    sendToFocused(channel: string, ...args: any[]): void;
    sendToAll(channel: string, payload: any, windowIdsToIgnore?: number[]): void;
    getFocusedWindow(): VSCodeWindow;
    getWindowById(windowId: number): VSCodeWindow;
    getWindows(): VSCodeWindow[];
    getWindowCount(): number;
    private onWindowError(vscodeWindow, error);
    private onBeforeWindowClose(win);
    private onWindowClosed(win);
    private isPathEqual(pathA, pathB);
}
